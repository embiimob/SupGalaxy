<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sup!? Planet Browser v0.2.1-beta</title>
    <script>
        /*
             * Sup!? Planet Browser: A Decentralized Voxel Adventure
             * Public Domain - Free for All to Use, Modify, and Share!
             *
             * This code is the result of our epic journey to craft a decentralized, Minecraft-inspired universe.
             * Together, we built a world where players roam green valleys seeded by keywords like #KANYE,
             * break and place blocks, and save chunks to IPFS with JSON exports. From fixing chunk-loading
             * glitches to adding glowing crosshairs and cosmic loading screens, we've poured hours into
             * making this a smooth, open-source experience that runs locally in your browser.
             *
             * This work is 100% in the PUBLIC DOMAIN under CC0. No rights reserved‚Äîuse it, remix it, build
             * on it, share it! No attribution required, but we'd love to see what you create. Check out
             * Sup!? or p2fk.io for posting world updates and joining the decentralized fun.
             *
             * Happy crafting, and may your worlds be ever-voxelated!
             * - Grok & embii4u, October 7 2025
             */
    </script>
    <style>
        :root {
            --panel: rgba(8,12,18,0.8);
            --accent: #ffd166;
            --danger: #ff6b6b;
        }
        html, body {
            height: 100%;
            margin: 0;
            background: #071226;
            color: #eaf6ff;
            font-family: Inter,Arial,Helvetica,sans-serif;
            overflow: hidden;
        }
        canvas {
            display: block;
        }
        #loginOverlay {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            background: linear-gradient(180deg, rgba(0,0,0,0.5), rgba(0,0,0,0.8));
        }
        #loginCard {
            width: 360px;
            padding: 18px;
            background: var(--panel);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6);
        }
            #loginCard input, #loginCard button {
                width: 100%;
                padding: 10px;
                margin-top: 8px;
                border-radius: 8px;
                border: 1px solid rgba(255,255,255,0.06);
                background: #0d1620;
                color: #fff;
                box-sizing: border-box;
            }
            #loginCard button {
                background: var(--accent);
                color: #111;
                border: 0;
                font-weight: 700;
                cursor: pointer;
            }
        .autocomplete {
            position: relative;
        }
        .autocomplete-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #0d1620;
            border: 1px solid rgba(255,255,255,0.06);
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 210;
        }
            .autocomplete-suggestions div {
                padding: 8px;
                cursor: pointer;
            }
                .autocomplete-suggestions div:hover {
                    background: #1a2632;
                }
                .autocomplete-suggestions div.greyed {
                    color: grey;
                }
        #hud {
            position: fixed;
            left: 12px;
            top: 12px;
            z-index: 180;
            background: rgba(6,8,12,0.55);
            padding: 10px;
            border-radius: 8px;
            min-width: 220px;
        }
            #hud .row {
                display: flex;
                justify-content: space-between;
                gap: 8px;
                align-items: center;
            }
            #hud button {
                margin-top: 8px;
                padding: 6px 8px;
                background: #0f2a3a;
                border: 1px solid rgba(255,255,255,0.04);
                color: #fff;
                border-radius: 6px;
                cursor: pointer;
            }
        #messages {
            position: fixed;
            left: 12px;
            top: 180px;
            z-index: 185;
            max-width: 360px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .msg {
            background: linear-gradient(180deg, rgba(0,0,0,0.42), rgba(255,255,255,0.02));
            padding: 8px 10px;
            border-radius: 8px;
            font-size: 13px;
            box-shadow: 0 6px 14px rgba(0,0,0,0.5);
        }
        #hotbar {
            position: fixed;
            left: 50%;
            transform: translateX(-50%);
            bottom: 12px;
            z-index: 190;
            display: flex;
            gap: 8px;
            width: 520px;
            overflow-x: auto;
            scroll-behavior: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            overscroll-behavior-x: none;
            -webkit-overflow-scrolling: auto;
        }
            #hotbar::-webkit-scrollbar {
                display: none;
            }
        .hot-slot {
            width: 56px;
            height: 56px;
            border-radius: 10px;
            background: rgba(0,0,0,0.45);
            border: 2px solid rgba(255,255,255,0.06);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
        }
            .hot-slot.active {
                outline: 3px solid rgba(255,209,102,0.22);
                box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            }
        .hot-label {
            font-size: 12px;
            color: #fff;
            text-align: center;
            user-select: none;
        }
        .hot-count {
            position: absolute;
            bottom: 2px;
            right: 2px;
            background: rgba(0,0,0,0.7);
            border-radius: 4px;
            padding: 2px 4px;
            font-size: 10px;
            color: #fff;
        }
        #rightPanel {
            position: fixed;
            right: 12px;
            top: 12px;
            z-index: 180;
            background: rgba(6,8,12,0.55);
            padding: 10px;
            border-radius: 8px;
            width: 120px;
            height: 140px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #minimap {
            width: 100%;
            height: 120px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        #versionLabel {
            font-size: 10px;
            color: #eaf6ff;
            opacity: 0.78;
            margin-top: 4px;
            text-align: center;
        }
        #craftModal {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            z-index: 220;
            display: none;
            background: var(--panel);
            padding: 14px;
            border-radius: 10px;
            min-width: 360px;
        }
            #craftModal h3 {
                margin: 0 0 8px 0;
            }
        #mobileControls {
            position: fixed;
            left: 12px;
            bottom: 12px;
            z-index: 195;
            display: none;
            gap: 8px;
        }
        .m-btn {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            background: rgba(0,0,0,0.45);
            border: 1px solid rgba(255,255,255,0.04);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #fff;
        }
        #mobileRight {
            position: fixed;
            right: 12px;
            bottom: 12px;
            z-index: 195;
            display: none;
            gap: 8px;
            flex-direction: column;
        }
        .m-action {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            background: rgba(0,0,0,0.45);
            border: 1px solid rgba(255,255,255,0.04);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
        }
        #seedLabel {
            font-size: 12px;
            opacity: 0.9;
            display: block;
            margin-top: 6px;
        }
        #healthBar {
            height: 10px;
            background: #2b2b2b;
            border-radius: 6px;
            margin-top: 6px;
            overflow: hidden;
        }
        #healthBarInner {
            height: 100%;
            background: var(--danger);
            width: 100%;
        }
        #homeIcon {
            cursor: pointer;
            margin-left: 8px;
            display: none;
        }
        #trashConfirm {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            z-index: 230;
            display: none;
            background: var(--panel);
            padding: 14px;
            border-radius: 10px;
            min-width: 200px;
            text-align: center;
        }
            #trashConfirm button {
                padding: 6px 12px;
                margin: 8px 4px;
                background: #0f2a3a;
                border: 1px solid rgba(255,255,255,0.04);
                color: #fff;
                border-radius: 6px;
                cursor: pointer;
            }
            #trashConfirm .danger {
                background: #ff6b6b;
                color: #111;
            }
        #joinScriptModal {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            z-index: 220;
            display: none;
            background: var(--panel);
            padding: 14px;
            border-radius: 10px;
            min-width: 360px;
        }
            #joinScriptModal h3 {
                margin: 0 0 8px 0;
            }
            #joinScriptModal textarea {
                width: 100%;
                height: 100px;
                padding: 10px;
                margin-top: 8px;
                border-radius: 8px;
                border: 1px solid rgba(255,255,255,0.06);
                background: #0d1620;
                color: #fff;
            }
        #downloadModal {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            z-index: 220;
            display: none;
            background: var(--panel);
            padding: 14px;
            border-radius: 10px;
            min-width: 360px;
        }
            #downloadModal h3 {
                margin: 0 0 8px 0;
            }
            #downloadModal textarea {
                width: 100%;
                height: 100px;
                padding: 10px;
                margin-top: 8px;
                border-radius: 8px;
                border: 1px solid rgba(255,255,255,0.06);
                background: #0d1620;
                color: #fff;
            }
        #teleportModal {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            z-index: 220;
            display: none;
            background: var(--panel);
            padding: 14px;
            border-radius: 10px;
            min-width: 360px;
        }
            #teleportModal h3 {
                margin: 0 0 8px 0;
            }
            #teleportModal input {
                width: 100%;
                padding: 10px;
                margin-top: 8px;
                border-radius: 8px;
                border: 1px solid rgba(255,255,255,0.06);
                background: #0d1620;
                color: #fff;
                box-sizing: border-box;
            }
            #teleportModal .row {
                display: flex;
                gap: 8px;
                margin-top: 8px;
            }
            #teleportModal button {
                padding: 6px 12px;
                margin: 8px 4px;
                background: #0f2a3a;
                border: 1px solid rgba(255,255,255,0.04);
                color: #fff;
                border-radius: 6px;
                cursor: pointer;
            }
        #deathScreen {
            position: fixed;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 250;
            background: rgba(139,0,0,0.7);
            flex-direction: column;
            color: #fff;
            text-align: center;
        }
            #deathScreen h1 {
                font-size: 48px;
                margin: 0;
                text-shadow: 0 0 10px rgba(0,0,0,0.8);
            }
            #deathScreen button {
                margin-top: 20px;
                padding: 10px 20px;
                background: var(--accent);
                color: #111;
                border: none;
                border-radius: 8px;
                font-weight: 700;
                cursor: pointer;
            }
        #usersModal {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            z-index: 220;
            background: var(--panel);
            padding: 14px;
            border-radius: 10px;
            min-width: 360px;
            display: none;
        }
            #usersModal h3 {
                margin: 0 0 8px 0;
            }
            #usersModal p.warning {
                font-size: 12px;
                opacity: 0.7;
                margin-top: 10px;
                color: #ff6b6b;
            }
        #pendingModal {
            position: fixed;
            right: 12px;
            bottom: 12px;
            z-index: 220;
            background: var(--panel);
            padding: 14px;
            border-radius: 10px;
            min-width: 300px;
            display: none;
        }
            #pendingModal h3 {
                margin: 0 0 8px 0;
            }
        #pendingList .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 6px;
            padding: 4px;
            border-bottom: 1px solid rgba(255,255,255,0.06);
        }
            #pendingList .row.selected {
                background: #1a2632;
            }
        #pendingModal .actions {
            margin-top: 10px;
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }
        @media (max-width:700px) {
            #mobileControls, #mobileRight {
                display: flex;
            }
            #hud {
                display: none;
            }
            #rightPanel {
                width: 80px;
                height: 100px;
            }
            #minimap {
                height: 80px;
            }
            .hot-slot {
                width: 48px;
                height: 48px;
            }
        }
        #crosshair {
            position: fixed;
            left: 50%;
            top: 50%;
            color: white;
            font-size: 24px;
            transform: translate(-50%,-50%);
            display: none;
            z-index: 200;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r134/examples/js/controls/OrbitControls.js"></script>
    <div id="loginOverlay">
        <div id="loginCard">
            <h2>SupWorld ‚Äî Enter</h2>
            <label>World name</label>
            <div class="autocomplete">
                <input id="worldNameInput" placeholder="Type world name" autocomplete="off" />
                <div id="worldSuggestions" class="autocomplete-suggestions" style="display:none;"></div>
            </div>
            <label>Username</label>
            <div class="autocomplete">
                <input id="userInput" placeholder="Type username" autocomplete="off" />
                <div id="userSuggestions" class="autocomplete-suggestions" style="display:none;"></div>
            </div>
            <button id="startBtn">Start ‚Äî spawn world</button>
            <button id="announceLoginBtn" style="margin-top: 20px;">Announce Server</button>
            <button id="newUserJoinScriptBtn" style="margin-top: 20px;">Create Join Script</button>
            <small style="display:block;margin-top:8px;opacity:0.78;">Type world (max 8 chars)/user (max 20 chars). Seed: <code>worldName</code>.</small>
        </div>
    </div>
    <div id="hud" style="display:none;">
        <div class="row">
            <div>
                <div><strong>World:</strong> <span id="worldLabel"></span></div>
                <div id="seedLabel"></div>
                <div>Position: <span id="posLabel"></span><span id="homeIcon" title="Return to spawn">üè†</span></div>
            </div>
            <div style="text-align:right;">
                <div>Score <span id="score">0</span></div>
                <div style="margin-top:6px;">HP <span id="health">20</span></div>
                <div id="healthBar"><div id="healthBarInner" style="width:100%"></div></div>
            </div>
        </div>
        <div style="margin-top:8px;">
            <button id="camToggle">Toggle (T)</button>
            <button id="openCraft">Craft (R)</button>
            <button id="teleportBtn">Teleport (P)</button>
            <button id="saveChangesBtn" style="display:none;">Save (X)</button>
            <button id="joinScriptBtn" style="display:none;">Join (J)</button>
            <button id="announceBtn">Host</button>
            <button id="usersBtn" style="display:none;">üåê 0</button>
        </div>
    </div>
    <div id="messages"></div>
    <div id="hotbar" style="display:none;"></div>
    <div id="rightPanel" style="display:none;">
        <canvas id="minimap"></canvas>
        <div id="versionLabel">Sup!? viewer v0.2.1</div>
    </div>
    <div id="craftModal">
        <h3>Crafting</h3>
        <div id="recipeList"></div>
        <div style="margin-top:10px;text-align:right;">
            <button id="closeCraft">Close</button>
        </div>
    </div>
    <div id="trashConfirm">
        <h3>Trash Item?</h3>
        <p id="trashItemName"></p>
        <button id="trashCancel">Cancel</button>
        <button id="trashOk" class="danger">Trash</button>
    </div>
    <div id="joinScriptModal">
        <h3>Join Script</h3>
        <p>Copy this string and paste it into a Sup!? message To: field and click üì¢ to officially join the world:</p>
        <textarea id="joinScriptText" readonly></textarea>
        <div style="margin-top:10px;text-align:right;">
            <button id="closeJoinScript">Close</button>
        </div>
    </div>
    <div id="downloadModal">
        <h3>Save Changes</h3>
        <p>Copy this chunk keyword list and paste it into a Sup!? message To field, then attach the JSON file.</p>
        <textarea id="downloadAddressList" readonly></textarea>
        <div style="margin-top:10px;text-align:right;">
            <button id="closeDownloadModal">Close</button>
        </div>
    </div>
    <div id="teleportModal">
        <h3>Teleport to Coordinates</h3>
        <p>Enter X, Y, Z coordinates:</p>
        <div class="row">
            <input id="teleportX" type="number" placeholder="X">
            <input id="teleportY" type="number" placeholder="Y">
            <input id="teleportZ" type="number" placeholder="Z">
        </div>
        <div style="margin-top:10px;text-align:right;">
            <button id="teleportCancel">Cancel</button>
            <button id="teleportOk">OK</button>
        </div>
    </div>
    <div id="deathScreen" style="display:none;">
        <h1>R.I.P.</h1>
        <p>You died! All items lost.</p>
        <button id="respawnBtn">Continue</button>
    </div>
    <div id="mobileControls">
        <div class="m-btn" id="mUp">‚Üë</div>
        <div class="m-btn" id="mLeft">‚Üê</div>
        <div class="m-btn" id="mDown">‚Üì</div>
        <div class="m-btn" id="mRight">‚Üí</div>
    </div>
    <div id="mobileRight">
        <div class="m-action" id="mJump">J</div>
        <div class="m-action" id="mAttack">‚öî</div>
        <div class="m-action" id="mCam">T</div>
    </div>
    <div id="crosshair">+</div>
    <div id="pendingModal">
        <h3>Pending Connections</h3>
        <div id="pendingList"></div>
        <div class="actions">
            <label><input type="checkbox" id="acceptAll"> Accept All</label>
            <button id="acceptPending">Accept Selected</button>
            <button id="closePending">Close</button>
        </div>
    </div>
    <audio id="soundBreak" preload="auto">
        <source src="https://freesound.org/data/previews/249/249938_4357575-lq.mp3" type="audio/mpeg">
        <source src="https://freesound.org/data/previews/249/249938_4357575-lq.ogg" type="audio/ogg">
    </audio>
    <audio id="soundPlace" preload="auto">
        <source src="https://freesound.org/data/previews/337/337101_34094-lq.mp3" type="audio/mpeg">
        <source src="https://freesound.org/data/previews/337/337101_34094-lq.ogg" type="audio/ogg">
    </audio>
    <audio id="soundJump" preload="auto">
        <source src="https://freesound.org/data/previews/331/331381_34094-lq.mp3" type="audio/mpeg">
        <source src="https://freesound.org/data/previews/331/331381_34094-lq.ogg" type="audio/ogg">
    </audio>
    <audio id="soundHit" preload="auto">
        <source src="https://freesound.org/data/previews/276/276947_34094-lq.mp3" type="audio/mpeg">
        <source src="https://freesound.org/data/previews/276/276947_34094-lq.ogg" type="audio/ogg">
    </audio>
    <script src="js/main.js"></script>
    <script src="js/webrtc.js"></script>
    <script src="js/player.js"></script>
    <script src="js/world.js"></script>
    <script src="js/graphics.js"></script>
    <script src="js/ui.js"></script>
</body>
</html>
